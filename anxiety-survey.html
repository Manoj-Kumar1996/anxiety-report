<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Anxiety Self-Assessment</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            background-color: #f7f7f7;
            font-family: Arial, sans-serif;
        }

        .question-container {
            display: none;
        }

        .btn-next {
            width: 100%;
        }

        .question-text {
            font-size: 20px;
            margin-bottom: 20px;
        }

        .popup-content {
            text-align: center;
        }

        .popup-content h5 {
            margin-bottom: 20px;
        }

        .popup-content input {
            margin-bottom: 10px;
            width: 100%;
        }

        .popup-content a {
            color: #007bff;
            text-decoration: none;
        }

        .popup-content a:hover {
            text-decoration: underline;
        }

        .fade-in {
            animation: fadeIn 0.5s ease-in-out;
        }

        .active {
            background-color: #007bff;
            color: white;
        }

        .active input {
            display: none;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }
    </style>
</head>

<body>

    <div class="container ftco-section">
        <div class="row">
            <div class="col-md-6 m-auto">
                <div class="card shadow">
                    <div class="card-body">
                        <h3 class="card-title text-center">Anxiety Self-Assessment</h3>
                        <p class="pb-3">Instructions: For each statement, select the answer that best describes how
                            you’ve been feeling.</p>

                        <form id="anxietyForm">
                            <!-- Question 1 -->
                            <div id="question-1" class="question-container fade-in">
                                <p class="question-text">1. Feeling nervous, anxious, or on edge</p>
                                <div class="mb-3 answer">
                                    <label class="form-check-label">
                                        <input type="radio" name="q1" value="0"> Not at all
                                    </label>
                                </div>
                                <div class="mb-3 answer">
                                    <label class="form-check-label">
                                        <input type="radio" name="q1" value="1"> Several days
                                    </label>
                                </div>
                                <div class="mb-3 answer">
                                    <label class="form-check-label">
                                        <input type="radio" name="q1" value="2"> More than half the days
                                    </label>
                                </div>
                                <div class="mb-3 answer">
                                    <label class="form-check-label">
                                        <input type="radio" name="q1" value="3"> Nearly every day
                                    </label>
                                </div>
                                <button type="button" class="btn btn-primary btn-next"
                                    onclick="nextQuestion(1)">Next</button>
                            </div>

                            <!-- Question 2 -->
                            <div id="question-2" class="question-container fade-in">
                                <p class="question-text">2. Not being able to stop or control worrying</p>
                                <div class="mb-3 answer">
                                    <label class="form-check-label">
                                        <input type="radio" name="q2" value="0"> Not at all
                                    </label>
                                </div>
                                <div class="mb-3 answer">
                                    <label class="form-check-label">
                                        <input type="radio" name="q2" value="1"> Several days
                                    </label>
                                </div>
                                <div class="mb-3 answer">
                                    <label class="form-check-label">
                                        <input type="radio" name="q2" value="2"> More than half the days
                                    </label>
                                </div>
                                <div class="mb-3 answer">
                                    <label class="form-check-label">
                                        <input type="radio" name="q2" value="3"> Nearly every day
                                    </label>
                                </div>
                                <button type="button" class="btn btn-primary btn-next"
                                    onclick="nextQuestion(2)">Next</button>
                            </div>

                            <!-- Question 3 -->
                            <div id="question-3" class="question-container fade-in">
                                <p class="question-text">3. Worrying too much about different things</p>
                                <div class="mb-3 answer">
                                    <label class="form-check-label">
                                        <input type="radio" name="q3" value="0"> Not at all
                                    </label>
                                </div>
                                <div class="mb-3 answer">
                                    <label class="form-check-label">
                                        <input type="radio" name="q3" value="1"> Several days
                                    </label>
                                </div>
                                <div class="mb-3 answer">
                                    <label class="form-check-label">
                                        <input type="radio" name="q3" value="2"> More than half the days
                                    </label>
                                </div>
                                <div class="mb-3 answer">
                                    <label class="form-check-label">
                                        <input type="radio" name="q3" value="3"> Nearly every day
                                    </label>
                                </div>
                                <button type="button" class="btn btn-primary btn-next"
                                    onclick="nextQuestion(3)">Next</button>
                            </div>

                            <!-- Question 4 -->
                            <div id="question-4" class="question-container fade-in">
                                <p class="question-text">4. Trouble relaxing</p>
                                <div class="mb-3 answer">
                                    <label class="form-check-label">
                                        <input type="radio" name="q4" value="0"> Not at all
                                    </label>
                                </div>
                                <div class="mb-3 answer">
                                    <label class="form-check-label">
                                        <input type="radio" name="q4" value="1"> Several days
                                    </label>
                                </div>
                                <div class="mb-3 answer">
                                    <label class="form-check-label">
                                        <input type="radio" name="q4" value="2"> More than half the days
                                    </label>
                                </div>
                                <div class="mb-3 answer">
                                    <label class="form-check-label">
                                        <input type="radio" name="q4" value="3"> Nearly every day
                                    </label>
                                </div>
                                <button type="button" class="btn btn-primary btn-next"
                                    onclick="nextQuestion(4)">Next</button>
                            </div>

                            <!-- Question 5 -->
                            <div id="question-5" class="question-container fade-in">
                                <p class="question-text">5. Being so restless that it is hard to sit still</p>
                                <div class="mb-3 answer">
                                    <label class="form-check-label">
                                        <input type="radio" name="q5" value="0"> Not at all
                                    </label>
                                </div>
                                <div class="mb-3 answer">
                                    <label class="form-check-label">
                                        <input type="radio" name="q5" value="1"> Several days
                                    </label>
                                </div>
                                <div class="mb-3 answer">
                                    <label class="form-check-label">
                                        <input type="radio" name="q5" value="2"> More than half the days
                                    </label>
                                </div>
                                <div class="mb-3 answer">
                                    <label class="form-check-label">
                                        <input type="radio" name="q5" value="3"> Nearly every day
                                    </label>
                                </div>
                                <button type="button" class="btn btn-primary btn-next"
                                    onclick="nextQuestion(5)">Next</button>
                            </div>

                            <!-- Question 6 -->
                            <div id="question-6" class="question-container fade-in">
                                <p class="question-text">6. Becoming easily annoyed or irritable</p>
                                <div class="mb-3 answer">
                                    <label class="form-check-label">
                                        <input type="radio" name="q6" value="0"> Not at all
                                    </label>
                                </div>
                                <div class="mb-3 answer">
                                    <label class="form-check-label">
                                        <input type="radio" name="q6" value="1"> Several days
                                    </label>
                                </div>
                                <div class="mb-3 answer">
                                    <label class="form-check-label">
                                        <input type="radio" name="q6" value="2"> More than half the days
                                    </label>
                                </div>
                                <div class="mb-3 answer">
                                    <label class="form-check-label">
                                        <input type="radio" name="q6" value="3"> Nearly every day
                                    </label>
                                </div>
                                <button type="button" class="btn btn-primary btn-next"
                                    onclick="nextQuestion(6)">Next</button>
                            </div>

                            <!-- Question 7 -->
                            <div id="question-7" class="question-container fade-in">
                                <p class="question-text">7. Feeling afraid as if something awful might happen</p>
                                <div class="mb-3 answer">
                                    <label class="form-check-label">
                                        <input type="radio" name="q7" value="0"> Not at all
                                    </label>
                                </div>
                                <div class="mb-3 answer">
                                    <label class="form-check-label">
                                        <input type="radio" name="q7" value="1"> Several days
                                    </label>
                                </div>
                                <div class="mb-3 answer">
                                    <label class="form-check-label">
                                        <input type="radio" name="q7" value="2"> More than half the days
                                    </label>
                                </div>
                                <div class="mb-3 answer">
                                    <label class="form-check-label">
                                        <input type="radio" name="q7" value="3"> Nearly every day
                                    </label>
                                </div>
                                <button type="button" class="btn btn-primary btn-next"
                                    onclick="nextQuestion(7)">Next</button>
                            </div>

                            <!-- Result Popup -->
                            <div id="resultPopup" style="display: none;">
                                <div class="popup-content">
                                    <div class="row">
                                        <div class="col-md-12">
                                            <button type="button" class="btn btn-primary w-100" data-bs-toggle="modal"
                                                data-bs-target="#introModal">
                                                Show Report
                                            </button>
                                        </div>
                                        <div class="col-md-12 d-flex justify-content-center py-3">
                                            <hr>
                                            <div class="">
                                                <p class="px-3">OR</p>
                                            </div>
                                            <hr>
                                        </div>
                                        <div class="col-md-12">
                                            <div class="input-group mb-3">
                                                <div class="input-group-append w-100">
                                                    <button id="submitReport" class="btn w-100 btn-primary text-white"
                                                        type="button">Download your report</button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="introModal" tabindex="-1" aria-labelledby="introModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="introModalLabel">Anxiety Assessment Report</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-6">
                            <div id="results" class="result-section text-center">
                                <div class="anxiety-image">
                                    <img class="img-fluid" style="width: 60%;" id="anxietyImage" src="" alt="">
                                </div>
                                <h5>Your Anxiety Score: <span id="anxietyScore"></span></h5>
                                <p id="resultMessage"></p>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="">
                                <p>Category:</p>
                                <ul>
                                    <li>0-4 points: Minimal anxiety or no symptoms.</li>
                                    <li>5-9 points: Mild anxiety.</li>
                                    <li>10-14 points: Moderate anxiety.</li>
                                    <li>15-21 points: Severe anxiety.</li>
                                </ul>
                            </div>
                            <div class="">
                                <p>Important:</p>
                                <ul>
                                    <li>This assessment is intended to help you reflect on your symptoms but should not
                                        be used as a definitive diagnosis. If your score suggests moderate or severe
                                        anxiety (10 points or more), it is advisable to seek professional consultation
                                        for a more thorough evaluation.</li>
                                    <li>If you experience thoughts of self-harm or overwhelming distress, please reach
                                        out for immediate support through a mental health professional or Call the
                                        helpline at 988.
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <!-- jsPDF -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <!-- SheetJS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <!-- SweetAlert -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <script>
        let currentQuestion = 1;
        let score = 0;

        // Initially show the first question
        document.getElementById("question-1").style.display = "block";

        function nextQuestion(questionNumber) {
            // Check if an answer is selected for the current question
            let selectedOption = document.querySelector(`input[name="q${questionNumber}"]:checked`);

            if (!selectedOption) {
                alert('Please select an answer before moving to the next question.');
                return;
            }

            // Calculate the score for the current question
            score += parseInt(selectedOption.value);

            // Hide the current question
            document.getElementById(`question-${questionNumber}`).style.display = "none";

            // Move to the next question
            currentQuestion++;
            if (currentQuestion <= 7) {
                let nextQuestionElement = document.getElementById(`question-${currentQuestion}`);
                nextQuestionElement.classList.add('fade-in');
                nextQuestionElement.style.display = 'block';
            } else {
                showResult();
            }
        }

        function showResult() {
            let resultMessage = "";
            let anxietyImage = document.getElementById('anxietyImage');
            if (score <= 4) {
                resultMessage = "Minimal anxiety or no symptoms.";
                anxietyImage.src = 'https://static.wixstatic.com/media/ab0b6b_fcd166f4f16e44f092529262036a6bef~mv2.png';
            } else if (score <= 9) {
                resultMessage = "Mild anxiety.";
                anxietyImage.src = 'https://static.wixstatic.com/media/ab0b6b_a4832c2af50144c28559a3019f429f11~mv2.png';
            } else if (score <= 14) {
                resultMessage = "Moderate anxiety.";
                anxietyImage.src = 'https://static.wixstatic.com/media/ab0b6b_7350f763ea394738a082c4c4742b6f28~mv2.png';
            } else if (score <= 21) {
                resultMessage = "Severe anxiety.";
                anxietyImage.src = 'https://static.wixstatic.com/media/ab0b6b_e23677bee0da4f50a8b53435c956fb10~mv2.png';
            }

            document.getElementById("anxietyScore").textContent = score;
            document.getElementById("resultMessage").textContent = resultMessage;
            document.getElementById("resultPopup").style.display = 'block';
        }



        document.getElementById('submitReport').addEventListener('click', (e) => {
            e.preventDefault();

            const score = document.getElementById("anxietyScore").textContent;
            const resultMessage = document.getElementById("resultMessage").textContent;

            Swal.fire({
                title: "Download Report",
                text: "Choose a format:",
                icon: "info",
                showCancelButton: true,
                confirmButtonText: "Download PDF",
                cancelButtonText: "Download Excel"
            }).then((result) => {
                if (result.isConfirmed) {
                    generatePDF(score, resultMessage);
                } else {
                    generateExcel(score, resultMessage);
                }
            });
        });

        // Function to generate PDF with Banner and Additional Text
        function generatePDF(score, resultMessage) {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            const bannerImageURL = "https://static.wixstatic.com/media/ab0b6b_ce2a11a7ca32433dabbdb75e351dd804~mv2.png"; // Ensure this path is correct

            const img = new Image();
            img.src = bannerImageURL;
            img.crossOrigin = "Anonymous"; // Ensure cross-origin handling for local/remote images

            img.onload = function () {
                doc.addImage(img, "PNG", 10, 10, 190, 40); // Ensure format is PNG if the image is in PNG

                doc.setFontSize(18);
                doc.text("Anxiety Report", 10, 60);

                doc.setFontSize(12);
                doc.text(`Score: ${score}`, 10, 75);
                doc.text(`Result: ${resultMessage}`, 10, 85);

                // Category Information
                doc.setFontSize(14);
                doc.text("Category:", 10, 100);
                doc.setFontSize(12);
                doc.text("• 0-4 points: Minimal anxiety or no symptoms.", 15, 110);
                doc.text("• 5-9 points: Mild anxiety.", 15, 120);
                doc.text("• 10-14 points: Moderate anxiety.", 15, 130);
                doc.text("• 15-21 points: Severe anxiety.", 15, 140);

                // Important Notes
                doc.setFontSize(14);
                doc.text("Important:", 10, 155);
                doc.setFontSize(12);
                const importantText = [
                    "• This assessment is intended to help you reflect on your symptoms but should not",
                    "  be used as a definitive diagnosis. If your score suggests moderate or severe",
                    "  anxiety (10 points or more), it is advisable to seek professional consultation.",
                    "• If you experience thoughts of self-harm or overwhelming distress, please reach",
                    "  out for immediate support through a mental health professional or call 988."
                ];
                let yPosition = 165;
                importantText.forEach((line) => {
                    doc.text(line, 15, yPosition);
                    yPosition += 8; // Space between lines
                });

                doc.save("Anxiety_Report.pdf");
            };

            img.onerror = function () {
                alert("Failed to load banner image. Please check the path or file format.");
            };
        }

        // Function to generate Excel
        function generateExcel(score, resultMessage) {
            const wb = XLSX.utils.book_new();
            const wsData = [
                ["Anxiety Report"],
                ["Score", score],
                ["Result", resultMessage],
                [],
                ["Category"],
                ["0-4 points", "Minimal anxiety or no symptoms."],
                ["5-9 points", "Mild anxiety."],
                ["10-14 points", "Moderate anxiety."],
                ["15-21 points", "Severe anxiety."],
                [],
                ["Important"],
                ["This assessment is intended to help you reflect on your symptoms but should not be used as a definitive diagnosis."],
                ["If your score suggests moderate or severe anxiety (10+ points), seek professional consultation."],
                ["If you experience thoughts of self-harm, reach out to a mental health professional or call 988."]
            ];
            const ws = XLSX.utils.aoa_to_sheet(wsData);
            XLSX.utils.book_append_sheet(wb, ws, "Report");
            XLSX.writeFile(wb, "Anxiety_Report.xlsx");
        }
    </script>

</body>

</html>